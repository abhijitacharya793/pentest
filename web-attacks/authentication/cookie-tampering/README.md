# Cookie tampering

* Change cookie
* Add different cookies that might authenticate
  * Header
  * XHR...
* Verify cookie entropy

<mark style="color:red;">**Cookie Attributes to look at:**</mark>

* **Expires & Max-Age**
  * **Expires** sets an expiry date for cookie&#x20;
  * **Max-age** sets the time when a cookie will be deleted
* **Domain**&#x20;
  * The Domain attribute specifies which hosts can receive a cookie.
* **Path**
  * Path attribute indicates a URL path that must exist in the requested URL in order to send the Cookie header&#x20;
  * `%x2F ("/")` character is considered a directory separator, and subdirectories match as well
* **SameSite**
  * This will indicate the browser if the cookie can be sent from other domains.&#x20;
  * It has 3 possible values:&#x20;
    * **Strict**: The cookie will not be sent along with request by third party websites.&#x20;
    * **Lax**: The cookie will be sent along with the GET request initiated by third party websites.&#x20;
    * **None**: The cookie is sent from any third party domain

<mark style="color:red;">**Cookie Flags to look at:**</mark>

* **HttpOnly**
  * This avoids the client to access the cookie (Via Javascript for example: document.cookie)
    * **Bypasses**
      * This could be Bypassed with **TRACE** **HTTP** requests as the response from the server (if this HTTP method is available) will reflect the cookies sent. This technique is called **Cross-Site Tracking**.
        * This technique is avoided by **modern browsers by not permitting sending a TRACE** request from JS. However, some bypassed to this have been found in specific software like sending `\r\nTRACE` instead of `TRACE` to IE6.0 SP2.
      * It's possible to **overwrite HttpOnly cookies** by performing a Cookie Jar overflow attack
* **Secure**
  * The request will **only** send the cookie in an HTTP request only if the request is transmitted over a secure channel (typically **HTTPS**).

## Cookie Prefix

The `Cookie Prefix` allows the send of cookie prefix information to ensure that certain attributes are present in a cookie request. Supported prefixes:

* `__Secure-`, tells the browser that the `Secure` attribute is required,
* `__Host-`, tells the browser that the `Path = /` and `Secure` attributes are required, and at the same time that the `Domain` attribute should not be present.

## Cookie-list Sorting

The [RFC6265](https://tools.ietf.org/html/rfc6265#section-5.4) standard defines the order of cookies:

```
2.  The user agent SHOULD sort the cookie-list in the following order:

    *  Cookies with longer paths are listed before cookies with shorter paths.

    *  Among cookies that have equal-length path fields, cookies with earlier creation-times are listed before cookies with later creation-times.
```

as a result, if the vulnerable application uses only the first cookie, you can force it to use your cookie by adding the `Path` attribute with longer path.
